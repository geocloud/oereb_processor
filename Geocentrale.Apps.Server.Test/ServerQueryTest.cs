using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;
using System.Xml;
using System.Xml.Linq;
using Geocentrale.Apps.DataContracts.Filter;
using Geocentrale.Apps.Db.Law;
using Geocentrale.Apps.Db.LexfindCache;
using Geocentrale.Apps.Db.RuleEngine;
using Geocentrale.Apps.Server.Helper;
using Geocentrale.Apps.Server.Modules;
using Geocentrale.Filter;
using Geocentrale.TestUtils;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Newtonsoft.Json;
using Oereb.Service.DataContracts.Model.Gml;

namespace Geocentrale.Apps.Server.Test
{
    [TestClass]
    public class ServerQueryTest
    {
        #region example request

        /* Request from 20.7.2015, attention objectId could change daily because there are updates on database
             
            {
                "appId": "84a0d662-f319-42a0-ab9f-566c3a010b91",
                "moduleId": "78833cf2-2d5e-42f7-b38e-2099c266e4de",
                "moduleParameters": {
                    "adminMode": false,
                    "project": "gis-daten-ag/nw/oereb"
                },
                "selections": [{
                    "classId": "4ca34e64-47d3-4aad-bcf1-dcbe78db5924",
                    "gaFilter": <gaFilter>,
                    "buffer": 0
                }],
                "format": "html"
            }             

        */

        #endregion

        [TestMethod, TestCategory("ServerQuery"), TestCategory(GATestCategory.MUSTRUNTEST)]
        public void CheckDatasetTypes()
        {
            Catalog.Catalog.LoadAppDefinition("gis-daten-ag/nw/oereb");

            var baselayerId = Guid.Parse("3d1a70de-c20e-445d-9e2e-17ef3afa6af9");

            Assert.IsFalse(Catalog.Catalog.IsLayerDataSet(baselayerId));

            var layerId = Guid.Parse("161e2705-8034-4121-b263-f4d7a52367ce");

            Assert.IsTrue(Catalog.Catalog.IsLayerDataSet(layerId));

            //pending
            //var layerClassGuid = Guid.Parse("7040a97a-3e5d-41d5-8d14-6479f2760ba5");
            //Assert.IsTrue(Catalog.Catalog.IsLayerDataSet(layerClassGuid));
        }

        [TestMethod, TestCategory("ServerQuery"), TestCategory(GATestCategory.MUSTRUNTEST)]
        public void ExportHtmlAndPdf()
        {
            Stopwatch stopwatch = new Stopwatch();

            // Begin timing.
            stopwatch.Start();

            //Catalog.Catalog.LoadAppDefinition("gis-daten-ag/nw/oereb"); //NW,OW
            Catalog.Catalog.LoadAppDefinition("lisag/ur/oereb"); //UR

            var module =  new OerebModule() as IMergerModule;

            Assert.IsNotNull(module);

            var mergerRequest = new MergerRequest();

            //mergerRequest.AppId = Guid.Parse("84a0d662-f319-42a0-ab9f-566c3a010b91"); //NW,OW
            mergerRequest.AppId = Guid.Parse("122647e8-52e0-43d9-b276-ddf691019562"); //UR

            mergerRequest.ModuleId = Guid.Parse("78833cf2-2d5e-42f7-b38e-2099c266e4de");
            mergerRequest.Format = "html";
            mergerRequest.ModuleParameters.Add("adminMode", false);

            var filter = new GAFilter();
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "OBJECTID",AttributeOperator.In, (int)4637598, typeof(int)));

            //parzelle 864 in Buochs, CH710574347858
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH710574347858", typeof(string)));

            //parzelle 342 in Dallenwil, CH710546347720
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH710546347720", typeof(string)));

            //parzelle 1039 in Beckenried, CH593478180541
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH593478180541", typeof(string)));

            //parzelle 656 in Hergiswil, CH451734770510
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH451734770510", typeof(string)));

            //parzelle 29 in Ennetbürgen, CH607705073442
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH607705073442", typeof(string)));

            //parzelle 1100 in Buochs, CH770577673472
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "EGRIS_EGRID", AttributeOperator.Like, "CH770577673472", typeof(string)));

            //parzelle 315 in Göschenen, CH530779463368
            //filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "egris_egrid", AttributeOperator.Like, "CH530779463368", typeof(string)));

            //parzelle 1164 in Altdorf, CH814670077804
            filter.Expression.ValueExpressions.Add(new GAValueExpression(BooleanOperator.And, "egris_egrid", AttributeOperator.Like, "CH814670077804", typeof(string)));

            var objectId = filter.Expression.ValueExpressions.First().Values.First();

            //NW,OW
            /*
            mergerRequest.Selections = new List<MergerRequest.JsonSelection>()
            {
                new MergerRequest.JsonSelection()
                {
                    classId = Guid.Parse("4ca34e64-47d3-4aad-bcf1-dcbe78db5924"), 
                    gaFilter = filter,
                    buffer = 0
                }
            };*/

            //UR
            /**/
            mergerRequest.Selections = new List<MergerRequest.JsonSelection>()
            {
                new MergerRequest.JsonSelection()
                {
                    classId = Guid.Parse("7ed1d09e-5401-454f-9d34-641ff3773acd"),
                    gaFilter = filter,
                    buffer = 0
                }
            };
            

            //this is necessary otherwise the db connection fails in some parts

            var dbLF = new LexFindCacheContainer();
            var dbRule = new RuleEngineContainer();
            var dbLaw = new OerebLaw3Container();

            var resultProcessing = module.Process(mergerRequest);

            Debug.Print("Processing Time elapsed: {0}", stopwatch.Elapsed);

            Assert.IsFalse(resultProcessing.HasError);

            var merger = new Merger();
            var exportModule = merger.GetExportModule(mergerRequest.ModuleId);

            //*****************************************************************************************************************
            //Xml

            var resultExportXml = exportModule.ToXml(mergerRequest, resultProcessing);

            Assert.IsNotNull(resultExportXml);
            Assert.IsTrue(resultExportXml.Length > 0);

            File.WriteAllText(Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}.xml"), resultExportXml, Encoding.Unicode);

            //*****************************************************************************************************************
            //Pdf

            var resultExportPdf = exportModule.ToPdf(mergerRequest, resultProcessing);

            Assert.IsNotNull(resultExportPdf);
            Assert.IsTrue(resultExportPdf.Length > 0);

            File.WriteAllBytes(Path.Combine(Path.GetTempPath(),$"{Guid.NewGuid()}.pdf"), resultExportPdf);

            //*****************************************************************************************************************
            //PdfA1a

            var resultExportPdfA1 = exportModule.ToPdfA1(mergerRequest, resultProcessing);

            Assert.IsNotNull(resultExportPdfA1);
            Assert.IsTrue(resultExportPdfA1.Length > 0);

            File.WriteAllBytes(Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}_A1.pdf"), resultExportPdfA1);

            //*****************************************************************************************************************
            //Json

            var resultExportJson = exportModule.ToJson(mergerRequest, resultProcessing);

            Assert.IsNotNull(resultExportJson);
            Assert.IsTrue(resultExportJson.Length > 0);

            File.WriteAllText(Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}.json"), resultExportJson);

            //*****************************************************************************************************************
            //Html

            var resultExportHtml = (string) exportModule.ToHtml(mergerRequest, resultProcessing).Value;

            Assert.IsNotNull(resultExportHtml);
            Assert.IsTrue(resultExportHtml.Length > 0);

            File.WriteAllText(Path.Combine(Path.GetTempPath(), $"{Guid.NewGuid()}.html"), resultExportHtml);

            stopwatch.Stop();

            Debug.Print("Total Time elapsed: {0}", stopwatch.Elapsed);
        }

        [TestMethod, TestCategory("ServerQuery"), TestCategory(GATestCategory.MUSTRUNTEST)]
        public void QueryEgrid()
        {

            // Mock the WebOperationContext
            var factory = new ChannelFactory<IMergerService>( // it must be an interface marked ServiceContract with minimum one OperationContract
                new WebHttpBinding(),
                new EndpointAddress("http://localhost:80")); // not relevant but must be set

            OperationContext.Current = new OperationContext(factory.CreateChannel() as IContextChannel);
            Assert.IsNotNull(WebOperationContext.Current);


            var status = Catalog.Catalog.LoadAppDefinition("gis-daten-ag/nw/oereb");

            Assert.IsTrue(status.Successful);

            var mergerRequest = new Merger();

            //this is necessary otherwise the db connection fails in some parts

            LexFindCacheContainer dbLF = new LexFindCacheContainer();
            var dbRule = new RuleEngineContainer();
            var dbLaw = new OerebLaw3Container();

            var stream = mergerRequest.GetReportByEgrid("gis-daten-ag/nw/oereb", "de", "pdf", "CH710574347858");
        }

        [TestMethod, TestCategory("ServerQuery"), TestCategory(GATestCategory.MUSTRUNTEST)]
        public void DESRequest()
        {
            var request = @"{""appId"":""84a0d662-f319-42a0-ab9f-566c3a010b91"",""moduleId"":""78833cf2-2d5e-42f7-b38e-2099c266e4de"",""moduleParameters"":{""adminMode"":false,""project"":""gis-daten-ag/nw/oereb""},""selections"":[{""classId"":""4ca34e64-47d3-4aad-bcf1-dcbe78db5924"",""gaFilter"":{""ChildFiltersBooleanOperator"":0,""ValueExpressionsToChildBooleanOperator"":0,""Expression"":{""BooleanOperator"":0,""ValueExpressions"":[{""Class"":""GaFilterExpression"",""BooleanOperator"":0,""AttributeName"":""OBJECTID"",""AttributeOperator"":0,""Values"":[4637019]}]},""Parent"":null,""Childs"":[],""Class"":""GaFilter""},""buffer"":0}],""format"":""html""}";

            List<string> serializationErrors = new List<string>();

            var mergerRequest = Newtonsoft.Json.JsonConvert.DeserializeObject<MergerRequest>(request, new JsonSerializerSettings
            {
                Error = (sender, args) =>
                {
                    serializationErrors.Add(args.ErrorContext.Error.Message);
                    args.ErrorContext.Handled = true;
                }
            });

        }

        [TestMethod, TestCategory("ServerQuery"), TestCategory(GATestCategory.WORKINPROGRESS)]
        public void TestGml()
        {
            string wkt = "POLYGON((0.1 0, 0 100, 100 100, 0 100))";

            var gml = Common.Geometry.GetGeometry(wkt, "gml", 21781);

            /* Ogr Export GML version 3
            
            <gml:Polygon srsName="urn:ogc:def:crs:EPSG::21781">
                <gml:exterior>
                    <gml:LinearRing>
                        <gml:posList>0.1 0.0 0 100 100 100 0 100</gml:posList>
                    </gml:LinearRing>
                </gml:exterior>
            </gml:Polygon> 

            */

            var gmlElement = XElement.Parse($"<container xmlns:gml=\"http://www.opengis.net/gml/3.2\" >{gml}</container>");
            var polygonElement = gmlElement.Descendants().First();

            polygonElement.Add(new XAttribute("id", $"{Guid.NewGuid()}.1"));

            var gmlModified = polygonElement.ToString();

            /* Ogr Export GML version 3 modified
             
            <gml:Polygon srsName="urn:ogc:def:crs:EPSG::21781" id="fb47f9b6-bbf5-4ec6-b9b8-ecc5cdb8be72.1" xmlns:gml="http://www.opengis.net/gml/3.2">
              <gml:exterior>
                <gml:LinearRing>
                  <gml:posList>0.1 0.0 0 100 100 100 0 100</gml:posList>
                </gml:LinearRing>
              </gml:exterior>
            </gml:Polygon>
             
            */

            //*************************************************************************************************************************************************
            //*************************************************************************************************************************************************
            /* Qgis

            <gml:Polygon srsName="urn:ogc:def:crs:EPSG::21781" gml:id="piste.geom.1">
                <gml:exterior>
                    <gml:LinearRing>
                        <gml:posList srsDimension="3">736953.054 187034.376 1635.726018 736950.887 187029.834 1634.96962 736951.029 187024.6 1634.0432635 736950.644 187017.731 1633.0911135 736951.013 187011.147 1632.372527 736950.098 187006.084 1631.866552 736952.304 186998.458 1630.538926 736952.365 186993.197 1630.07967 736950.11 186988.664 1629.86586 736949.539 186982.536 1629.8902685 736950.742 186977.557 1629.6753195 736949.104 186972.03 1629.404039 736948.792 186966.41 1628.901917 736947.605 186960.921 1628.50132 736946.491 186954.998 1627.9246925 736945.311 186948.779 1627.2511855 736944.122 186943.115 1626.699474 736943.065 186937.883 1626.186842 736941.283 186932.36 1625.71799 736938.986 186927.764 1625.359602 736936.424 186922.452 1624.99216 736934.919 186916.417 1624.266274 736933.151 186911.157 1624.16962 736930.869 186906.263 1624.159714 736931.393 186900.063 1623.861234 736932.168 186894.33 1623.34486 736933.261 186888.83 1622.6967 736934.392 186883.454 1622.059486 736934.66 186877.991 1621.6430985 736935.317 186871.631 1620.6987735 736935.734 186866.463 1619.9483805 736936.122 186861.025 1619.1328805000001 736936.483 186855.355 1618.1615045000001 736936.884 186849.454 1617.201393 736937.409 186843.401 1616.2045015000001 736938.097 186837.301 1615.223727 736938.932 186831.065 1613.869594 736939.753 186824.688 1612.489545 736940.499 186818.064 1611.081295 736941.312 186811.114 1609.534499 736942.103 186803.766 1607.960456 736942.58 186798.709 1606.8913935 736943.011 186793.53 1605.8201425 736943.371 186788.272 1604.6441755000001 736943.489 186782.915 1603.490225 736943.256 186777.52 1602.4047 736942.58 186772.116 1601.354486 736941.45 186766.868 1600.239568 736940.129 186761.623 1599.1484765 736939.065 186756.22 1598.19402 736937.079 186751.271 1597.766819 736934.852 186746.405 1597.406033 736931.536 186742.108 1596.967266 736929.727 186737.006 1596.0359845 736926.915 186732.587 1596.145645 736924.052 186728.362 1595.933734 736919.75 186722.38 1595.557815 736915.153 186716.897 1595.357221 736910.499 186711.735 1595.368537 736906.63 186706.459 1595.150861 736902.436 186701.631 1594.872055 736898.507 186697.02 1594.6337715 736894.781 186692.542 1594.5248655 736891.287 186688.191 1594.412037 736887.868 186684.043 1594.26369 736883.878 186678.996 1594.061544 736879.798 186674.065 1593.937237 736875.846 186669.595 1593.806839 736872.111 186665.303 1593.683003 736869.529 186660.398 1593.521672 736865.324 186657.109 1593.522733 736861.065 186652.916 1593.464002 736857.247 186648.834 1593.336363 736853.818 186644.938 1593.200016 736849.931 186640.736 1593.226336 736846.413 186637.011 1593.168661 736842.688 186633.366 1592.761005 736838.979 186629.755 1592.1205255 736834.971 186625.785 1591.4842145 736830.63 186621.298 1590.967141 736827.782 186617.178 1590.509427 736824.883 186613.004 1590.0291655000001 736822.267 186608.342 1589.4179695 736819.63 186603.494 1588.757745 736817.233 186599.037 1588.0838105 736814.722 186594.059 1587.0194515000001 736812.19 186589.725 1585.9945525000001 736809.6 186584.538 1584.884815 736806.962 186579.337 1583.9039635 736803.952 186574.178 1583.001226 736800.941 186569.029 1581.900498 736798.736 186563.44 1580.669368 736796.991 186557.488 1579.445509 736795.153 186551.563 1578.571223 736793.281 186546.048 1577.765979 736791.438 186540.26 1576.823047 736789.845 186534.922 1575.8330485 736788.39 186529.188 1574.694719 736786.662 186523.771 1573.8353185000001 736784.84 186518.734 1573.050947 736782.946 186513.373 1571.9303625 736780.696 186508.425 1570.8728995 736779.12 186502.455 1569.4920725 736777.631 186497.362 1568.3471055 736775.498 186492.272 1567.204403 736773.48 186486.882 1565.981713 736771.451 186481.127 1564.360574 736769.98 186475.833 1562.7840645000001 736768.701 186470.096 1561.1346585 736767.88 186464.432 1559.923452 736768.264 186458.129 1558.5514575 736768.335 186452.932 1557.8855525 736768.023 186447.87 1557.300512 736768.704 186442.069 1556.5927385 736769.355 186436.866 1555.890032 736769.979 186431.216 1554.881813 736770.98 186424.877 1553.6405515 736771.898 186419.799 1552.5390725 736772.857 186414.757 1551.40616 736773.935 186409.663 1550.236188 736775.051 186404.459 1549.040348 736776.245 186398.873 1547.732391 736777.428 186392.815 1546.4591825 736778.614 186386.482 1545.157204 736779.666 186379.991 1543.8280595000001 736780.566 186373.469 1542.838635 736781.239 186366.894 1542.0024985 736781.862 186360.177 1541.151563 736782.568 186353.637 1540.283375 736783.534 186346.906 1539.374925 736785.067 186340.206 1538.4389435000001 736787.027 186333.823 1537.6698945000001 736789.396 186327.613 1536.9658725 736791.979 186321.176 1536.207844 736794.558 186314.73 1535.303606 736797.231 186308.21 1534.242942 736799.96 186301.744 1533.187312 736802.841 186294.963 1531.975301 736805.72 186288.233 1530.736416 736808.664 186281.519 1529.495088 736810.706 186276.817 1528.7449425 736812.716 186272.1 1528.34655 736814.677 186267.346 1527.94989 736816.722 186262.655 1527.5502375000001 736818.648 186257.996 1527.108998 736821.346 186251.254 1526.397041 736824.241 186244.706 1525.667761 736826.851 186238.444 1524.978896 736829.368 186232.301 1523.9635255000001 736831.986 186225.926 1522.882457 736834.502 186219.656 1521.848046 736837.037 186212.997 1520.745314 736838.786 186208.286 1519.964952 736843.998 186194.235 1517.6487705 736845.729 186189.451 1516.9173365 736847.353 186184.668 1516.199964 736849.025 186179.8 1515.46835 736850.706 186174.993 1514.9540575000001 736852.319 186170.236 1514.573744 736853.974 186165.416 1514.186784 736855.685 186160.672 1513.7214795 736858.551 186154.067 1513.881384 736861.431 186148.174 1514.577775 736864.067 186143.452 1515.135454 736867.277 186138.607 1515.6955315 736870.775 186134.35 1515.200475 736874.281 186130.264 1514.566764 736876.512 186125.575 1513.8825495000001 736880.672 186122.199 1513.2533735 736885.022 186118.376 1512.14758 736888.746 186114.298 1511.005628 736891.982 186110.435 1509.955178 736895.368 186106.069 1508.804854 736899.521 186101.697 1507.54927 736904.053 186097.036 1506.4438155 736908.635 186092.433 1505.69095 736913.227 186088.164 1504.9596645 736917.843 186084.199 1504.246583 736922.378 186080.311 1503.7807485000001 736926.928 186076.612 1503.48881 736931.269 186073.112 1503.131742 736935.477 186069.742 1502.787993 736939.458 186066.544 1502.461764 736944.083 186062.757 1501.9936125 736948.626 186059.048 1501.524248 736952.751 186055.518 1500.822985 736956.675 186052.341 1500.0899485 736960.761 186049.284 1499.3413465000001 736965.131 186045.996 1498.3608235 736969.573 186042.477 1497.327277 736974.187 186038.922 1496.2746145000001 736978.963 186035.542 1495.3138705 736983.561 186032.136 1494.237535 736988.065 186028.887 1493.1569055 736992.372 186025.788 1492.130494 736996.557 186022.999 1491.2162875 737000.714 186020.209 1490.287172 737005.528 186016.851 1489.061347 737009.963 186013.988 1487.936734 737014.745 186011.22 1486.80101 737019.816 186008.385 1485.620817 737025.371 186005.553 1484.47448 737030.017 186003.189 1483.519138 737034.594 186001.068 1482.628086 737040.327 185998.656 1481.5491075 737046.018 185996.3 1480.805645 737051.556 185993.955 1480.061865 737057.047 185991.837 1479.3668525 737062.428 185989.843 1478.617505 737067.712 185987.919 1477.787155 737073.021 185985.983 1476.9884265000001 737078.592 185983.989 1476.248821 737084.107 185982.162 1475.2686835 737089.32 185980.582 1474.285802 737094.201 185979.391 1473.4350155 737099.861 185978.304 1472.5178335000001 737105.091 185977.439 1471.501374 737110.653 185976.185 1470.304122 737116.168 185974.841 1469.088317 737121.49 185973.425 1467.78652 737126.848 185972.274 1466.43037 737131.983 185971.407 1465.5427615000001 737137.171 185969.825 1464.3685135000001 737142.478 185968.037 1462.906111 737147.95 185966.001 1461.093643 737153.494 185964.056 1459.303618 737158.21 185961.984 1457.913052 737162.981 185959.209 1456.0841 737167.59 185955.736 1454.702496 737171.247 185951.129 1453.716465 737174.761 185947.201 1452.839329 737178.378 185942.475 1451.840199 737180.373 185937.636 1451.02815 737182.79 185931.898 1450.468115 737185.117 185926.238 1449.9145375000001 737186.866 185921.368 1449.433795 737188.047 185916.385 1448.7229125 737188.692 185911.241 1447.530504 737187.228 185906.305 1446.474936 737185.754 185901.308 1445.461031 737183.161 185897.026 1444.4600655 737181.248 185891.982 1442.858593 737179.574 185887.159 1441.4470165 737177.727 185882.21 1440.172413 737176.117 185876.801 1438.4347155 737173.984 185871.404 1437.03087 737171.146 185866.521 1435.827911 737169.467 185861.395 1434.2227995000001 737167.224 185855.615 1432.3963315000001 737165.253 185850.584 1430.8944385 737163.449 185844.81 1429.4528815000001 737161.832 185838.527 1427.8456635 737160.615 185833.597 1426.8555835 737159.308 185828.519 1425.895768 737157.838 185823.302 1424.891497 737156.526 185817.703 1423.819612 737155.153 185811.815 1422.7817675 737152.1 185799.507 1420.3200825 737150.659 185792.923 1419.0302325 737149.466 185786.081 1417.8315105 737148.296 185779.14 1416.782146 737146.42 185772.63 1416.154805 737144.269 185766.507 1415.4267095 737143.346 185760.391 1414.608196 737142.136 185754.77 1414.038989 737140.488 185749.72 1413.220672 737139.06 185744.815 1412.4151575000001 737137.192 185738.705 1411.467362 737134.936 185732.759 1410.269654 737132.019 185727.312 1409.093518 737128.888 185722.567 1408.577222 737125.452 185718.451 1408.260614 737121.432 185714.948 1407.475698 737117.01 185711.285 1406.2331625 737112.162 185707.36 1404.615189 737106.803 185703.293 1403.353541 737102.287 185699.945 1402.381761 737097.461 185696.225 1401.4316705000001 737092.586 185692.138 1400.505277 737087.843 185688.182 1399.775695 737083.432 185684.762 1399.665359 737079.22 185681.721 1399.4771035000001 737073.778 185678.049 1398.7417845 737068.359 185674.763 1397.50769 737063.036 185671.705 1396.6048785 737057.88 185668.579 1395.8744695 737052.858 185665.347 1394.8134305000001 737047.992 185661.946 1394.397769 737043.383 185658.608 1394.0021195 737039.21 185655.279 1393.194583 737035.24 185651.984 1392.125848 737030.548 185647.947 1390.821777 737026.382 185644.028 1390.197848 737022.569 185640.164 1389.607868 737018.351 185635.927 1388.630892 737014.425 185631.589 1387.227852 737010.854 185627.7 1385.969724 737006.738 185623.539 1384.691337 737002.924 185619.982 1383.603666 736998.852 185616.599 1382.500447 736994.883 185613.108 1381.234605 736990.545 185609.666 1379.978461 736984.223 185604.742 1378.7981565 736980.081 185601.69 1378.1715155 736975.687 185598.583 1377.3217585 736971.192 185595.558 1376.336495 736966.652 185592.527 1375.3211295000001 736961.864 185589.536 1374.53604 736956.624 185586.734 1373.653709 736951.041 185583.896 1372.5612875 736945.105 185581.137 1371.3434415 736939.046 185577.828 1370.013217 736932.681 185574.566 1369.2159375000001 736926.196 185571.062 1368.34687 736919.792 185567.521 1367.348338 736913.283 185564.17 1366.4004625 736906.72 185560.876 1365.184142 736900.077 185557.526 1363.998179 736895.467 185555.478 1363.6780155 736890.89 185553.24 1363.324345 736886.385 185550.918 1362.9047625000001 736881.899 185548.554 1362.0578835 736877.409 185546.172 1361.383442 736873.015 185543.744 1360.8226885 736866.711 185540.001 1359.935696 736860.815 185536.249 1359.334735 736855.179 185532.762 1359.033041 736849.744 185529.823 1358.784231 736844.613 185527.058 1358.5408535 736840.071 185524.338 1358.2943225 736834.802 185520.924 1357.731617 736829.928 185518.305 1356.8740235 736825.202 185516.328 1356.104143 736820.762 185513.967 1355.327487 736816.501 185511.059 1354.357583 736811.865 185507.992 1353.281797 736807.108 185504.837 1352.1189315 736802.464 185501.522 1350.920535 736797.701 185498.202 1349.7328725 736792.894 185494.746 1348.663864 736788.289 185491.521 1347.673339 736783.414 185487.984 1346.560517 736778.238 185483.935 1345.3592275000001 736773.907 185480.213 1344.386968 736769.72 185476.438 1343.518821 736765.66 185472.851 1342.7883945000001 736761.884 185469.367 1342.124715 736757.731 185465.148 1341.3764055 736754.313 185461.193 1340.5746445 736750.094 185458.01 1339.484809 736746.119 185454.637 1338.525945 736742.238 185451.009 1337.341488 736737.814 185448.14 1336.16757 736733.165 185445.289 1335.078093 736728.513 185441.797 1333.984339 736723.666 185438.566 1332.911586 736718.778 185435.842 1331.924896 736714.235 185432.664 1330.969368 736709.471 185429.385 1329.975504 736705.271 185426.546 1329.131908 736700.107 185423.657 1328.187936 736695.207 185420.59 1327.332348 736690.181 185417.496 1326.30941 736685.329 185414.583 1325.2313965000001 736681.052 185411.895 1324.1695695000001 736676.39 185409.262 1323.079476 736672.307 185406.155 1321.948888 736667.521 185403.307 1320.860435 736662.695 185400.296 1319.735338 736657.408 185397.105 1318.6258325 736652.21 185394.043 1317.6410225 736647.094 185391.091 1316.6860925000001 736642.466 185388.681 1315.6635015 736636.913 185385.925 1314.3341135000001 736632.278 185383.617 1313.2444625000001 736627.394 185381.321 1312.3902625000001 736622.685 185378.959 1311.5351625000001 736618.225 185376.579 1311.0315345 736612.461 185373.739 1310.9433505 736606.934 185370.779 1310.827463 736601.615 185368.131 1310.7305795 736596.556 185365.453 1310.29365 736591.764 185363.0 1309.677452 736587.118 185360.772 1309.019526 736581.85 185358.351 1308.2896785 736576.879 185356.025 1307.459151 736571.853 185353.542 1306.537284 736566.967 185350.853 1305.594081 736562.812 185347.756 1304.75536 736557.943 185344.679 1303.9492655 736553.343 185341.67 1302.976402 736549.132 185338.232 1301.471408 736544.824 185334.206 1300.09347 736540.704 185330.367 1298.7501805 736536.74 185325.625 1297.6261475 736533.408 185320.907 1296.936958 736530.677 185316.626 1296.6058035000001 736527.873 185312.477 1296.2070325 736525.038 185307.315 1295.4313585 736522.66 185302.415 1294.5946125 736519.906 185297.98 1293.841846 736517.992 185293.312 1292.759752 736514.396 185288.881 1291.659651 736511.392 185284.141 1290.5358895 736508.449 185279.523 1289.479064 736505.271 185274.854 1288.1112055000001 736502.959 185270.012 1286.797494 736501.139 185265.029 1285.535063 736498.918 185259.489 1284.077229 736497.517 185254.393 1282.9184265 736495.592 185249.552 1281.801004 736494.384 185243.51 1280.400602 736493.176 185237.691 1279.4972485000001 736491.982 185232.585 1278.7411585 736491.434 185227.333 1277.9127785000001 736490.912 185221.992 1276.80274 736490.534 185216.506 1275.672571 736490.639 185205.59 1273.6395115 736490.265 185200.189 1272.4913205 736490.363 185195.154 1271.3834665 736490.648 185189.516 1270.108882 736491.064 185183.86 1269.015894 736491.646 185178.096 1268.026215 736492.417 185172.325 1266.792962 736493.344 185166.383 1265.5122565 736494.534 185160.331 1264.090159 736495.743 185154.789 1263.0201595000001 736497.908 185148.428 1262.017498 736499.601 185143.399 1261.2251305 736502.199 185138.332 1260.452497 736505.27 185132.852 1259.730882 736508.908 185128.801 1259.2028205 736512.658 185125.072 1258.718145 736517.074 185122.092 1258.333126 736522.39 185119.141 1257.997271 736527.328 185116.633 1257.7203215 736532.386 185114.898 1257.534339 736537.584 185113.101 1257.3408955 736541.196 185109.542 1256.828307 736544.455 185105.711 1256.270863 736547.813 185101.818 1255.7054845 736551.891 185098.306 1255.2200815000001 736555.378 185094.512 1254.375895 736559.497 185090.958 1253.5806375 736563.748 185088.018 1252.097422 736568.085 185085.449 1250.576529 736572.875 185083.423 1249.100423 736578.108 185081.669 1247.9114125000001 736583.228 185080.491 1246.8409495000001 736588.104 185079.225 1245.5233725000001 736593.08 185078.697 1244.5030765 736594.87820219004 185078.63994039001 1244.1911423500001 736613.23321118997 185080.08047360001 1241.2878147399999 736620.08374830999 185097.46820336999 1242.7881761199999 736629.60184875003 185096.13717614999 1242.21967625 736628.61105981003 185088.88907510001 1240.74378989 736623.45602637006 185089.53803463999 1241.04952022 736622.40347183996 185081.40258102 1239.4170128000001 736622.27904884005 185081.41392620999 1239.42350674 736621.75203202001 185077.34696625001 1238.64367838 736623.89494006999 185077.07705031999 1238.53153853 736623.91396232997 185077.22602469 1238.5531729500001 736628.71798495005 185076.77990256 1238.3255429400001 736628.68895096995 185076.47194210999 1238.2804754900001 736628.01835194998 185069.92373996001 1237.32682183 736622.76088305004 185070.46215546 1237.8146737699999 736610.67521119001 185070.8124736 1240.0824831899999 736601.12121119001 185070.76447359999 1241.64873829 736586.403 185073.666 1244.497567 736581.419 185074.769 1245.3335395 736576.467 185076.505 1246.6137535 736571.316 185078.415 1248.158333 736566.233 185080.292 1249.656226 736561.866 185082.775 1251.161593 736557.447 185086.151 1252.3259055000001 736553.494 185089.785 1253.145144 736549.749 185093.576 1254.0086775 736541.84 185100.406 1255.331433 736537.461 185102.965 1255.6609275000001 736532.248 185104.282 1255.781981 736527.123 185105.401 1255.8847055000001 736521.878 185106.365 1255.9607525 736516.18 185107.757 1256.1388085000001 736511.133 185109.084 1256.3290805 736505.861 185110.889 1256.603184 736500.645 185113.631 1257.035884 736496.666 185116.754 1257.528118 736493.022 185120.587 1258.1125165000001 736490.066 185125.018 1258.774957 736487.599 185129.556 1259.451713 736485.55 185134.467 1260.1560115 736483.965 185139.777 1260.9293295 736482.53 185145.152 1261.777352 736479.353 185160.404 1264.406243 736478.4 185165.585 1265.709185 736476.644 185171.472 1267.228044 736475.092 185177.433 1268.753109 736473.839 185183.47 1269.869197 736473.089 185189.532 1270.9205495000001 736472.858 185194.6 1271.777423 736472.957 185199.846 1272.6978995 736473.332 185205.031 1273.693958 736473.971 185210.06 1274.7348655000001 736475.038 185216.198 1275.993975 736476.063 185222.373 1277.0563245000001 736476.864 185228.277 1278.3556635 736477.813 185234.153 1279.6517245 736478.729 185240.144 1280.8731105 736479.727 185245.14 1281.7458895 736481.08 185251.18 1282.70332 736482.322 185257.002 1283.691089 736483.665 185262.566 1284.8452645 736485.046 185268.087 1285.9598085 736487.349 185273.733 1287.252039 736490.178 185279.285 1288.730901 736493.215 185284.359 1289.898625 736496.637 185289.156 1291.0452165 736499.828 185293.236 1292.033816 736502.814 185298.157 1293.1704155 736505.424 185302.464 1293.964392 736507.793 185307.396 1294.848175 736510.785 185312.195 1295.8358875 736514.041 185316.953 1296.8885645 736517.415 185321.684 1297.8886665 736521.094 185326.469 1298.271527 736524.694 185331.102 1298.544825 736528.111 185335.176 1299.243127 736531.573 185339.27 1300.067702 736535.432 185344.126 1301.043257 736538.919 185348.635 1302.8108215 736542.506 185352.669 1304.4122915 736546.208 185356.412 1305.456882 736549.984 185359.723 1306.200562 736554.306 185363.073 1307.023776 736558.642 185365.633 1307.396163 736563.283 185368.112 1308.065514 736568.018 185370.489 1308.8707985000001 736572.842 185372.657 1309.6691025 736577.564 185374.795 1310.4529585 736583.126 185377.377 1311.243123 736588.624 185379.808 1311.891992 736594.154 185382.259 1312.570709 736599.823 185384.403 1313.1999725000001 736605.399 185386.477 1313.2992545 736611.212 185388.61 1313.454929 736616.194 185390.603 1313.8385855 736621.703 185393.135 1314.4739125000001 736627.385 185395.829 1315.7436655 736632.535 185398.452 1317.080651 736637.094 185400.563 1318.1673395 736642.441 185402.95 1318.9713275 736646.883 185405.902 1319.7550805000001 736651.085 185408.945 1320.6173 736655.271 185411.876 1321.643467 736660.355 185415.407 1322.885131 736665.321 185418.507 1324.0628625 736670.002 185421.475 1325.081128 736674.744 185424.488 1326.099036 736679.737 185427.422 1327.0476235000001 736684.781 185430.183 1327.992707 736689.61 185433.18 1328.84895 736693.991 185436.208 1329.608145 736698.425 185439.155 1330.442275 736702.778 185441.834 1331.261779 736707.316 185444.511 1332.2035445 736712.233 185446.887 1333.1022205 736716.869 185449.335 1333.8262625 736721.851 185452.226 1334.725496 736726.101 185455.378 1335.758871 736730.473 185459.043 1336.989756 736734.775 185461.624 1338.104793 736738.648 185464.976 1339.031876 736742.545 185468.745 1340.0896925 736746.296 185472.247 1341.130293 736750.023 185475.928 1341.7800115 736753.698 185479.92 1342.601969 736757.517 185483.827 1343.500865 736761.298 185487.797 1344.349372 736765.448 185491.755 1345.316956 736769.789 185495.693 1346.340303 736774.395 185499.534 1347.6643055 736779.15 185503.135 1348.988375 736784.024 185506.456 1350.29898 736789.224 185509.666 1351.649575 736794.338 185513.136 1352.599002 736798.774 185516.601 1353.5115175000001 736802.757 185519.78 1354.666713 736807.957 185523.02 1356.173113 736813.242 185526.044 1357.484035 736818.568 185528.853 1357.9802615000001 736823.786 185531.669 1358.7845725 736828.337 185533.746 1359.2211395 736833.443 185535.895 1359.483197 736838.971 185538.906 1360.0042395 736843.429 185541.385 1360.622846 736848.198 185543.732 1361.20173 736853.016 185546.17 1361.807519 736857.806 185548.703 1362.4545135000001 736862.538 185551.307 1363.0908215 736867.105 185553.999 1363.72342 736871.649 185556.642 1364.337062 736876.204 185559.068 1364.98372 736880.738 185561.366 1365.655305 736886.667 185564.404 1366.5668275 736891.149 185566.821 1367.2970785 736895.774 185569.366 1367.800281 736900.506 185571.896 1368.337777 736905.229 185574.448 1369.21721 736909.853 185576.884 1369.893922 736914.392 185579.161 1370.5669525000001 736920.338 185581.897 1371.417403 736926.262 185584.676 1372.222981 736932.138 185587.768 1373.152055 736937.986 185590.948 1374.208179 736943.663 185593.829 1375.3502345 736949.178 185596.118 1376.214623 736954.714 185598.972 1377.160946 736960.089 185602.593 1378.4077895 736964.726 185606.366 1379.487573 736968.977 185609.952 1380.504081 736973.566 185612.801 1381.2483105 736977.845 185616.028 1382.097715 736981.941 185619.508 1383.081381 736985.799 185623.016 1384.142185 736990.24 185627.037 1385.3584755 736994.997 185630.852 1386.7386285 736999.596 185634.459 1388.067045 737003.65 185638.525 1389.27645 737007.476 185641.825 1389.768006 737010.926 185645.468 1390.306012 737014.898 185649.097 1391.216852 737019.224 185652.804 1392.267248 737023.51 185656.751 1393.130347 737027.372 185660.137 1393.8617665 737031.539 185663.567 1394.3973985 737035.866 185667.149 1395.1465725 737040.096 185670.794 1395.999621 737044.314 185674.379 1396.5028905 737048.854 185677.962 1397.621112 737053.846 185681.533 1398.315061 737059.06 185685.21 1399.138555 737063.908 185689.22 1399.870256 737068.579 185692.964 1400.6016875 737073.35 185696.296 1401.382711 737077.988 185699.515 1402.0237345 737082.568 185702.818 1402.446087 737087.099 185706.026 1402.7029905 737091.497 185708.872 1403.272 737095.518 185711.896 1404.541592 737100.447 185715.441 1406.015385 737105.002 185719.114 1407.15677 737109.237 185723.05 1407.8187215 737113.136 185727.438 1408.621836 737116.243 185732.457 1409.700204 737118.627 185737.639 1410.690008 737120.565 185742.654 1411.485246 737122.176 185747.702 1412.102604 737123.854 185752.986 1412.748608 737125.672 185758.475 1413.623481 737127.087 185763.933 1414.4022545 737128.57 185769.403 1415.186666 737129.93 185774.804 1416.049149 737131.257 185780.351 1417.138201 737132.537 185786.076 1418.5076035 737133.552 185791.822 1419.462463 737134.529 185797.262 1420.3666245 737135.827 185802.973 1421.985727 737136.846 185808.72 1423.355631 737137.594 185814.046 1424.635294 737139.122 185819.164 1425.822087 737141.033 185824.885 1426.8420175000001 737142.628 185830.629 1427.898489 737144.084 185835.471 1428.789076 737145.822 185840.459 1429.898678 737147.389 185845.762 1431.3000375 737148.908 185851.218 1432.736445 737150.716 185856.603 1434.0931015000001 737152.44 185861.857 1435.692555 737154.07 185866.952 1437.26762 737155.823 185872.107 1438.754904 737157.968 185877.453 1440.257394 737160.535 185882.424 1441.906419 737162.751 185887.365 1443.6826155000001 737165.386 185892.583 1445.5327435 737167.512 185897.527 1446.7618845 737169.098 185902.509 1447.673275 737170.503 185907.555 1448.584269 737171.836 185912.967 1449.44987 737171.828 185918.383 1450.5412095 737171.011 185923.731 1451.4346865 737170.226 185928.921 1452.261872 737168.352 185934.109 1453.219829 737165.517 185938.787 1454.263339 737161.578 185941.956 1455.171501 737156.448 185944.787 1456.2119575 737151.411 185946.968 1457.171065 737146.237 185948.898 1457.92318 737140.821 185950.605 1458.6497575000001 737135.586 185951.808 1459.794043 737130.268 185952.911 1461.0367815 737124.776 185954.142 1462.328683 737119.124 185955.889 1463.7532985 737113.95 185957.272 1464.957857 737108.734 185958.574 1466.253698 737103.297 185959.872 1467.7074415 737098.393 185961.286 1468.9134575 737093.523 185962.528 1469.8212095 737088.255 185964.003 1470.892924 737082.55 185965.823 1472.0948415 737076.963 185966.668 1472.8884665 737071.31 185968.356 1473.667963 737065.508 185970.017 1474.443606 737060.716 185971.839 1475.163562 737055.836 185973.756 1475.873038 737050.024 185975.71 1476.648232 737045.129 185977.585 1477.3446845000001 737040.081 185979.636 1478.0737585 737035.048 185981.812 1478.836742 737029.95 185984.088 1479.547983 737024.809 185986.487 1480.288942 737019.559 185989.186 1481.127455 737014.424 185992.014 1482.256343 737009.525 185994.546 1483.295411 737004.988 185997.072 1484.29908 737000.223 186000.137 1485.482603 736995.451 186003.011 1486.703536 736990.681 186006.259 1487.986896 736985.941 186009.198 1489.1686805 736981.159 186012.099 1490.343293 736976.25 186015.206 1491.490878 736971.44 186018.442 1492.604371 736967.23 186021.465 1493.4206025000001 736962.579 186024.939 1494.348598 736958.442 186027.986 1495.164837 736954.152 186031.034 1495.988091 736950.072 186034.024 1496.788876 736937.692 186043.869 1499.1955895000001 736933.356 186047.505 1499.9716915 736928.925 186050.915 1500.711765 736924.416 186054.572 1501.497306 736919.965 186058.785 1502.2964575000001 736915.462 186062.94 1502.878099 736910.762 186066.832 1503.449625 736905.884 186070.681 1504.022367 736902.116 186074.229 1504.511343 736898.451 186077.818 1505.088746 736894.69 186081.251 1506.103398 736890.996 186084.767 1507.142974 736887.353 186088.499 1508.215286 736883.145 186093.064 1509.499152 736879.379 186097.184 1510.6980845 736875.838 186100.95 1511.83029 736872.086 186104.915 1512.9729875 736868.408 186109.227 1514.1422585 736864.879 186113.58 1515.2831055 736862.221 186118.186 1516.2489125 736860.134 186122.854 1516.484205 736856.962 186126.725 1516.339833 736854.361 186131.118 1516.153883 736852.103 186135.705 1515.963842 736849.164 186141.259 1515.552648 736846.448 186146.25 1515.069032 736843.565 186151.981 1514.515833 736840.684 186158.252 1513.93459 736837.915 186164.786 1514.6935735 736835.332 186171.369 1515.455319 736832.878 186177.949 1516.211924 736830.515 186184.573 1517.0550095000001 736828.227 186191.238 1517.914537 736825.852 186197.919 1518.8061405000001 736823.374 186204.518 1520.032696 736820.891 186210.928 1521.23038 736818.415 186217.063 1522.4262255000001 736815.876 186222.945 1523.3267405 736813.288 186228.695 1524.2174315 736810.69 186234.426 1525.105773 736808.148 186240.285 1525.899484 736803.32 186252.326 1527.161752 736800.835 186258.298 1527.7866405 736798.308 186264.24 1528.477972 736795.8 186270.2 1529.1984 736793.356 186275.928 1529.893172 736791.023 186281.445 1530.7520595000001 736788.682 186286.779 1531.6997015 736786.322 186291.907 1532.619773 736784.037 186296.956 1533.5368885 736781.882 186301.897 1534.3258025 736779.879 186306.721 1535.052368 736777.975 186311.408 1535.6072665 736775.385 186317.502 1536.3267385 736772.789 186323.421 1537.094616 736770.542 186329.321 1537.7979235 736768.673 186335.097 1538.408912 736767.606 186341.036 1539.028537 736767.108 186347.124 1539.660718 736766.641 186353.374 1540.3591005000001 736766.339 186359.325 1541.125385 736765.813 186365.048 1541.8995365000001 736764.796 186370.561 1542.6440055 736763.493 186376.412 1543.407841 736762.479 186381.369 1544.35728 736761.41 186386.491 1545.501001 736760.441 186391.779 1546.680308 736759.637 186396.889 1547.824633 736758.452 186402.964 1549.18608 736757.335 186408.249 1550.389493 736756.314 186413.248 1551.528085 736755.495 186418.257 1552.66118 736754.284 186424.339 1553.8322625000001 736753.034 186430.121 1555.0117165 736752.191 186435.843 1556.188979 736751.84 186441.298 1557.29152 736751.453 186446.796 1558.359464 736750.938 186452.608 1559.045244 736750.923 186457.68 1559.616774 736751.396 186462.788 1560.906632 736752.179 186468.821 1562.31143 736752.896 186474.11 1563.357101 736754.584 186479.723 1564.307996 736756.601 186484.87 1565.434848 736758.362 186490.524 1567.15612 736759.949 186495.991 1568.8201155 736761.562 186501.319 1570.084813 736763.382 186506.746 1571.194057 736765.224 186512.331 1572.337222 736767.29 186517.924 1573.625504 736768.61 186522.886 1574.331104 736770.273 186528.112 1575.0703525 736772.028 186532.931 1575.9410595 736773.402 186537.916 1576.841539 736775.095 186543.913 1577.9547105 736777.091 186549.395 1578.9172795 736779.33 186554.81 1579.865945 736781.486 186560.574 1580.887921 736783.257 186565.387 1581.7975685 736784.931 186570.286 1582.730288 736787.02 186575.159 1583.733798 736789.036 186579.992 1584.734826 736791.391 186585.596 1585.7945595000001 736793.885 186590.411 1586.791945 736796.666 186594.859 1587.7218415 736799.915 186599.373 1588.541625 736803.248 186603.979 1589.0742655 736806.769 186608.769 1589.6244365 736810.044 186613.627 1590.345474 736813.094 186618.253 1591.0916285000001 736816.192 186622.681 1591.7360175 736819.29 186626.794 1592.386538 736822.53 186631.245 1592.9159175 736826.115 186635.652 1593.498497 736829.509 186639.912 1593.987045 736833.287 186643.884 1594.182163 736837.17 186647.689 1594.109226 736840.911 186651.207 1594.01531 736844.865 186655.331 1594.016242 736848.185 186659.287 1594.1915525 736851.733 186663.315 1594.4351625 736856.013 186667.126 1594.5012475000001 736859.893 186671.656 1594.5466975 736863.553 186676.619 1594.677851 736867.272 186680.22 1594.824678 736870.53 186684.204 1595.059974 736874.007 186688.355 1595.2563645 736877.633 186692.541 1595.4142635000001 736881.459 186696.9 1595.5714755 736885.564 186701.282 1596.005394 736889.691 186705.921 1596.6020875 736893.64 186711.103 1596.840047 736896.61 186715.138 1596.910097 736899.671 186719.277 1597.1785615 736902.819 186723.567 1597.8559445000001 736906.014 186727.994 1598.610337 736909.241 186732.624 1598.9380405 736912.595 186737.456 1598.7746855 736915.798 186742.392 1599.253745 736918.716 186747.366 1600.022575 736921.189 186752.164 1600.9144065 736923.415 186756.806 1601.675798 736926.114 186762.819 1602.0053595 736927.915 186767.544 1602.308556 736929.222 186772.661 1603.1331205 736929.629 186777.976 1604.35028 736928.84 186784.543 1605.8115125 736927.719 186790.308 1607.146862 736926.928 186795.929 1608.4306235 736926.113 186801.414 1609.782386 736925.435 186806.705 1611.128295 736924.895 186811.701 1612.387139 736924.21 186817.566 1613.691714 736923.566 186823.293 1614.8010305 736922.799 186829.054 1615.9290365 736922.092 186834.016 1616.908366 736921.473 186839.411 1617.9065645000001 736920.9 186845.042 1618.655777 736920.35 186850.945 1619.4339325000001 736920.047 186857.079 1620.2041405 736919.812 186862.837 1621.1748745 736919.719 186869.054 1622.257444 736919.959 186874.63 1623.193144 736919.667 186879.685 1623.9250595000001 736919.388 186885.266 1624.342652 736919.494 186890.98 1624.724569 736919.739 186896.109 1625.0499275 736920.162 186901.649 1625.269222 736921.018 186907.608 1625.392944 736922.082 186912.497 1625.451046 736923.835 186918.406 1625.5857735 736926.004 186923.919 1626.3983135000001 736927.995 186929.097 1627.166307 736929.624 186934.032 1627.66332 736931.438 186939.7 1628.207862 736932.911 186945.264 1628.816364 736934.115 186950.817 1629.325613 736934.985 186955.932 1629.835808 736935.87 186961.121 1629.9331945 736936.157 186966.302 1630.336907 736935.93 186971.462 1630.880335 736936.609 186976.776 1631.381564 736940.357 186997.271 1631.228064 736941.013 187003.109 1632.005037 736940.921 187008.142 1632.791224 736940.908 187013.811 1633.670777 736941.411 187019.666 1634.4576985000001 736941.659 187025.228 1635.2459245 736941.551 187030.707 1636.0641355 736941.72262273997 187031.90005100999 1636.2191767 736948.76814212999 187032.78149791999 1635.6966618199999 736947.94026347995 187039.39883861999 1636.78940119 736947.82409848005 187065.42018582 1638.0460023099999 736967.0991469 187051.55670047001 1634.9082144 736954.13134594995 187049.80829227 1636.74435623 736954.105 187039.325 1636.37629 736953.054 187034.376 1635.726018</gml:posList>
                    </gml:LinearRing>
                </gml:exterior>
            </gml:Polygon>

             */

            //*************************************************************************************************************************************************
            //*************************************************************************************************************************************************
            // Class Oereb.Service.DataContracts.Model.Gml

            var polygon = new Oereb.Service.DataContracts.Model.Gml.PolygonType();

            polygon.srsName = "urn:ogc:def:crs:EPSG::21781";
            polygon.id = "piste.geom.1";

            polygon.exterior = new AbstractRingPropertyType()
            {
                Item = new LinearRingType() {
                    Items = new object[]
                    {
                        new DirectPositionListType()
                        {
                            count = "4",
                            srsDimension = "2",
                            Text = "0.1, 0.0, 0, 100, 100, 100, 0, 100"
                        }
                    }
                } 
            };

            //invalid serialization from class does not work at this time
            //var polygonClass = Xml<PolygonType>.SerializeToXmlString(polygon);

            var wkt2 = "MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)),((15 5, 40 10, 10 20, 5 10, 15 5)))";

            var gml2 = Common.Geometry.GetGeometry(wkt2, "gml", 21781);

            /*
            
            <gml:MultiSurface srsName="urn:ogc:def:crs:EPSG::21781">
                <gml:surfaceMember>
                    <gml:Polygon>
                        <gml:exterior>
                            <gml:LinearRing>
                                <gml:posList>30 20 45 40 10 40 30 20</gml:posList></gml:LinearRing>
                            </gml:exterior>
                        </gml:Polygon>
                    </gml:surfaceMember>
                 <gml:surfaceMember>
                    <gml:Polygon>
                        <gml:exterior>
                            <gml:LinearRing>
                                <gml:posList>15 5 40 10 10 20 5 10 15 5</gml:posList>
                            </gml:LinearRing>
                        </gml:exterior>
                    </gml:Polygon>
                 </gml:surfaceMember>
            </gml:MultiSurface>
             
            */
        }

    }
}
